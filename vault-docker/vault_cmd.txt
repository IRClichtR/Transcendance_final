Vault commands

docker-compose exec vault bash

vault operator init

Unseal Key 1: YJ+R5se0QptJMRInVxOsDId0KQ2IqYXiFk77n8PhHiy+
Unseal Key 2: 9kboeXVs+L+RPE9wL+fmm2NVqWVrzjkS9afUntG0b+f5
Unseal Key 3: vPdb/tVH4//NU60jWO5RoNTBFYuUCNRQ51D+fnXwI/FP
Unseal Key 4: M9GuXSjUYoQjgFmNcDBS3NsVNTpKQeQoXrgldnpAWUXk
Unseal Key 5: b3qTMyHgoVverv0Um5V2Jg4ux50H3oVGA+rrBcw6rcH0

Initial Root Token: 14b657fc-7c83-4191-b310-3693bde9a1a9

vault operator unseal [key]
vault login [token]

# Audit
vault audit enable file file_path=/vault/logs/audit.log
vault audit list

# Secrets
vault kv put secret/foo bar=precious
vault kv get secret/foo
vault kv enable-versioning secret/
vault kv put secret/foo bar=copper
vault kv get -version=1 secret/foo
vault kv delete secret/foo				# delete last version
vault kv delete -versions=1 secret/foo
vault kv undelete -versions=1 secret/foo
vault kv destroy -versions=1 secret/foo

# Policies
vault policy write app /vault/policies/app-policy.json
vault token create -policy=app

Key                  Value
---                  -----
token                edd8a63f-e8c4-15b6-3c04-f0cd7db20853
token_accessor       5f2c4ab1-9b49-11a1-cb3a-5b42841244cf
token_duration       768h
token_renewable      true
token_policies       ["app" "default"]
identity_policies    []
policies             ["app" "default"]
bash-4.4# vault kv put secret/app/test ping=pong
Key              Value
---              -----
created_time     2024-08-24T17:23:36.284263018Z
deletion_time    n/a
destroyed        false
version          1

vault kv put secret/app/test ping=pong

# Encryption
vault secrets enable transit
vault write -f transit/keys/foo
vault write transit/encrypt/foo plaintext=$(base64 <<< "my precious hedgehog")
vault write transit/decrypt/foo ciphertext=vault:v1:lHejk9Q7IFMwQwOovjtgFCCQa2YJYp4ATGLEwjzVFtjlRf6+Jx0BfrJlzvVZryJycA==
base64 -d <<< "bXkgcHJlY2lvdXMgaGVkZ2Vob2cK"

# Revoking 
vault lease revoke -prefix [directory/]
vault lease revoke [lease id]

# Keys and Certificate generator
openssl req -new -newkey rsa:4096 -x509 -sha256 -days 365 -nodes -out localhost.crt -keyout localhost.key
